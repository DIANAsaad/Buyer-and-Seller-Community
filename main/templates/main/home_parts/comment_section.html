<div class="comment-section" id="comment-section-{{ post.id }}" style="display: none;">
    <div class="comments-container">
        <form method="post" action="/add_comment" class="comment-form">
            {% csrf_token %}
            <div class="comment-input-container">
                <textarea name="content" class="comment-box" placeholder="Add a comment..." required></textarea>
                <button type="submit" class="btn-comment">Add</button>
            </div>
            <input type="hidden" name="post-id" value="{{ post.id }}">
        </form>
        
        <div class="comments-display">
            {% for comment in post.comment_set.all|slice:":2" %}
                <div class="comment" style="position: relative; margin-bottom: 10px;">
                    <strong>{{ comment.author.username }}</strong>:
                    <span>{{ comment.content }}</span>
                    <span class="comment-timestamp">{{ comment.timestamp|date:"F j, Y, g:i a" }}</span>

                    {% if user == comment.author or perms.main.delete_comment %}
                        <form method="post" action="/delete_comment" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%);">
                            {% csrf_token %}
                            <button type="submit" class="btn btn-link text-danger" name="comment-id" value="{{ comment.id }}" style="padding: 0; border: none; background: transparent; text-decoration: none;">
                                Delete
                            </button>
                        </form>
                    {% endif %}
                </div>
            {% empty %}
                <p>No comments yet. Be the first to comment!</p>
            {% endfor %}
        </div>
    </div>
</div>

{% block extra_css %}
<style>
/* Comment Section Styles */
.comment-section {
    padding: 10px;
}
.comments-container {
    margin-top: 10px;
}
.comment {
    background-color: #f9f9f9;
    border-radius: 5px;
    padding: 10px;
    margin-bottom: 10px;
}
.comment-timestamp {
    font-size: 12px;
    color: #888;
}

/* Comment Input Styling */
.comment-input-container {
    display: flex;
    align-items: center;
    width: 100%;
}
.comment-box {
    flex-grow: 1;
    margin-right: 10px;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
    resize: none;
    height: 40px; /* Adjust height as needed */
    width: 100%;
    font-size: 14px;
    font-family: 'Lora', serif;
}
.btn-comment {
    padding: 8px 12px;
    background-color: rgb(173, 114, 55);
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    height: 40px; /* Match the height of the textarea */
}
.btn-comment:hover {
    background-color: rgb(173, 114, 55);
}
</style>
{% endblock %}
